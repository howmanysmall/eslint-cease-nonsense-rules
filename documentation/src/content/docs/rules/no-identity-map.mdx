---
title: no-identity-map
badge:
    text: Maintenance
    variant: note
description: Ban identity map calls like items.map(x => x).
---

import { Aside, Code, LinkCard, CardGrid, Card, Tabs, TabItem, Badge, Steps } from "@astrojs/starlight/components";

Ban identity `.map()` calls.

## Rule Details :badge[Maintenance]{variant=note}

Reports `.map()` calls where the callback just returns its input. These calls are redundant and create unnecessary array
copies and callbacks.

<Aside type="caution" title="Performance Impact">
	Every `.map()` call allocates a new array and iterates the whole collection. `items.map((x) => x)` is just a shallow
	copy with extra work.
</Aside>

## Refactoring Steps

<Steps>
1. **Analyze Purpose**
   Determine if the `.map(x => x)` was intended to create a shallow copy or if it's completely redundant.

2. **Remove Redundancy** If the copy isn't needed, simply remove the `.map()` call and use the original variable.

3. **Use spread for copies** If you need a shallow copy, use `[...original]`.

4. **Fix the type at the source** If mapping was only used to coerce types, fix the typing where the array is created
   (or use a proper type guard).

{/* oxfmt-ignore */}

</Steps>

## Examples

<Tabs>
	<TabItem label="❌ Incorrect" icon="close">
		### Identity Maps
		Bans patterns that return the item unchanged.

    	<Code
    		code={[
    			"// Array identity map",
    			"const copied = items.map((item) => item);",
    			"",
    			"// Binding identity map (roblox-ts)",
    			"const level = healthBinding.map((h) => h);",
    			"",
    			"// Block syntax identity",
    			"const list = data.map((x) => {",
    			"\treturn x;",
    			"});",
    		].join("\n")}
    		lang="tsx"
    	/>
    </TabItem>
    <TabItem label="✅ Correct" icon="check">
    	### Efficient Alternatives
    	Use the original reference if no change is needed, or use proper cloning methods.

    	<Code
    		code={[
    			"// Just use the original",
    			"const result = items;",
    			"",
    			"// Use spread for shallow copy",
    			"const copied = [...items];",
    			"",
    			"// Proper transformation",
    			"const doubled = numbers.map((n) => n * 2);",
    		].join("\n")}
    		lang="tsx"
    	/>
    </TabItem>

</Tabs>

## Why is this wasteful?

<CardGrid stagger>
	<Card title="Arrow Overhead" icon="bolt">
		`x => x` still involves a function call jump for every single element in your array.
	</Card>
	<Card title="Allocation" icon="list-format">
		Creates a whole new array in memory that is identical to the first, doubling heap usage
		temporarily.
	</Card>
	<Card title="Readability" icon="rocket">
		Code that "does nothing" is confusing to other developers; they'll look for hidden logic
		where none exists.
	</Card>
</CardGrid>

## Related Rules

<CardGrid>
	<LinkCard
		title="prefer-single-world-query"
		description="Optimizes ECS lookups"
		href="/eslint-cease-nonsense-rules/rules/prefer-single-world-query/"
	/>
</CardGrid>

## Further Reading

<CardGrid>
	<LinkCard
		title="MDN: Array.map()"
		description="Documentation for the array map method"
		href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"
	/>
</CardGrid>

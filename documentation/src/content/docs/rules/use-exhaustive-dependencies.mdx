---
title: use-exhaustive-dependencies
---

import { Code } from "@astrojs/starlight/components";

Enforces exhaustive and correct dependency specification in React hooks to prevent stale closures and unnecessary re-renders.

## Rule Details

This rule ensures that all dependencies used inside hook callbacks are listed in the dependency array, preventing bugs from stale closures while also detecting unnecessary dependencies that cause extra re-renders.

**External Documentation**: [Biome's use-exhaustive-dependencies](https://biomejs.dev/linter/rules/use-exhaustive-dependencies/)

## Options

<Code
	code={[
		"{",
		'\t"cease-nonsense/use-exhaustive-dependencies": [',
		'\t\t"error",',
		"\t\t{",
		'\t\t\t"reportMissingDependenciesArray": true,',
		'\t\t\t"reportUnnecessaryDependencies": true,',
		'\t\t\t"hooks": [',
		"\t\t\t\t{",
		'\t\t\t\t\t"name": "useCustomHook",',
		'\t\t\t\t\t"closureIndex": 0,',
		'\t\t\t\t\t"dependenciesIndex": 1,',
		'\t\t\t\t\t"stableResult": true,',
		"\t\t\t\t},",
		"\t\t\t],",
		"\t\t},",
		"\t],",
		"}",
	].join("\n")}
	lang="typescript"
	key="block-0-1jwga2"
/>

### Configuration Parameters

- **reportMissingDependenciesArray** (default: `true`): Report when dependency array is missing entirely
- **reportUnnecessaryDependencies** (default: `true`): Report dependencies that aren't used
- **hooks** (default: `[]`): Configuration for custom hooks

### Custom Hook Configuration

- **name**: Hook function name
- **closureIndex**: Parameter index of the callback function
- **dependenciesIndex**: Parameter index of the dependency array
- **stableResult**: Whether the hook returns stable references

## Examples

### ❌ Incorrect

<Code
	code={[
		"function UserProfile({ userId }) {",
		"\tconst [user, setUser] = useState(null);",
		"",
		"\t// Missing userId dependency",
		"\tuseEffect(() => {",
		"\t\tfetchUser(userId).then(setUser);",
		"\t}, []); // Should include userId",
		"",
		"\t// Missing dependency array entirely",
		"\tuseEffect(() => {",
		"\t\tdocument.title = `User ${userId}`;",
		"\t});",
		"",
		"\t// Unnecessary dependency",
		"\tuseEffect(() => {",
		'\t\tconsole.log("mounted");',
		"\t}, [userId]); // userId not used in effect",
		"",
		"\t// Stale closure",
		"\tconst [count, setCount] = useState(0);",
		"\tuseEffect(() => {",
		"\t\tconst id = setInterval(() => {",
		"\t\t\tconsole.log(count); // Always logs initial value!",
		"\t\t}, 1000);",
		"\t\treturn () => clearInterval(id);",
		"\t}, []); // Missing count",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-userprofile-15gecv"
/>

### ✅ Correct

<Code
	code={[
		"function UserProfile({ userId }) {",
		"\tconst [user, setUser] = useState(null);",
		"",
		"\t// Correct dependencies",
		"\tuseEffect(() => {",
		"\t\tfetchUser(userId).then(setUser);",
		"\t}, [userId]);",
		"",
		"\t// Empty array for mount-only effect",
		"\tuseEffect(() => {",
		'\t\tconsole.log("mounted once");',
		'\t\treturn () => console.log("unmounted");',
		"\t}, []);",
		"",
		"\t// All used values in deps",
		"\tconst [count, setCount] = useState(0);",
		"\tuseEffect(() => {",
		"\t\tconst id = setInterval(() => {",
		"\t\t\tconsole.log(count); // Current count",
		"\t\t}, 1000);",
		"\t\treturn () => clearInterval(id);",
		"\t}, [count]);",
		"",
		"\t// Or use functional update (no dep needed)",
		"\tuseEffect(() => {",
		"\t\tconst id = setInterval(() => {",
		"\t\t\tsetCount((c) => c + 1); // No dependency on count",
		"\t\t}, 1000);",
		"\t\treturn () => clearInterval(id);",
		"\t}, []);",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-userprofile-2ujoiv"
/>

## Common Patterns

### Props and State

<Code
	code={[
		"function Component({ userId, onUpdate }) {",
		"\tconst [data, setData] = useState(null);",
		"",
		"\tuseEffect(() => {",
		"\t\tfetchUser(userId).then((user) => {",
		"\t\t\tsetData(user);",
		"\t\t\tonUpdate(user);",
		"\t\t});",
		"\t}, [userId, onUpdate]); // All referenced values",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-component-u-3l1vxm"
/>

### Stable Functions

Use `useCallback` to stabilize function references:

<Code
	code={[
		"function Component({ userId }) {",
		"\t// Unstable: new function every render",
		"\tconst loadUser = () => fetchUser(userId);",
		"",
		"\tuseEffect(() => {",
		"\t\tloadUser();",
		"\t}, [loadUser]); // Runs every render!",
		"",
		"\t// Better: stabilize with useCallback",
		"\tconst loadUserStable = useCallback(() => {",
		"\t\tfetchUser(userId);",
		"\t}, [userId]);",
		"",
		"\tuseEffect(() => {",
		"\t\tloadUserStable();",
		"\t}, [loadUserStable]); // Only runs when userId changes",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-component-u-3akyfn"
/>

### Functional Updates

Avoid dependencies with functional state updates:

<Code
	code={[
		"function Counter() {",
		"\tconst [count, setCount] = useState(0);",
		"",
		"\t// ❌ Depends on count",
		"\tuseEffect(() => {",
		"\t\tconst id = setInterval(() => setCount(count + 1), 1000);",
		"\t\treturn () => clearInterval(id);",
		"\t}, [count]); // Recreates interval on every change",
		"",
		"\t// ✅ No dependency on count",
		"\tuseEffect(() => {",
		"\t\tconst id = setInterval(() => setCount((c) => c + 1), 1000);",
		"\t\treturn () => clearInterval(id);",
		"\t}, []); // Stable interval",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-counter-3s31ye"
/>

### Refs (Stable)

Refs don't need to be in dependencies:

<Code
	code={[
		"function Component() {",
		"\tconst inputRef = useRef<HTMLInputElement>(null);",
		"",
		"\tuseEffect(() => {",
		"\t\tinputRef.current?.focus(); // Ref not in deps (stable)",
		"\t}, []); // OK",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-component-2gzn08"
/>

## Custom Hooks

Configure custom hooks similar to React's built-in hooks:

<Code
	code={[
		"{",
		'  "hooks": [{',
		'    "name": "useInterval",',
		'    "closureIndex": 0,       // Callback is first param',
		'    "dependenciesIndex": 2,  // Deps array is third param',
		'    "stableResult": false    // Returns non-stable values',
		"  }]",
		"}",
	].join("\n")}
	lang="typescript"
	key="block-7-1lvtkb"
/>

<Code
	code={[
		"// Usage",
		"useInterval(",
		"\t() => {",
		"\t\tdoSomething(value);",
		"\t},",
		"\t1000,",
		"\t[value],",
		"); // Third param is deps",
	].join("\n")}
	lang="typescript"
	key="usage-3bzl3m"
/>

## Exhaustive Dependencies Explained

### Stale Closures

Without proper dependencies, closures capture stale values:

<Code
	code={[
		"function Component() {",
		"\tconst [count, setCount] = useState(0);",
		"",
		"\tuseEffect(() => {",
		"\t\t// Captures count = 0 at mount",
		"\t\tsetTimeout(() => {",
		"\t\t\tconsole.log(count); // Always 0!",
		"\t\t}, 5000);",
		"\t}, []); // Missing count",
		"",
		"\t// Fix: add count to deps",
		"\tuseEffect(() => {",
		"\t\tsetTimeout(() => {",
		"\t\t\tconsole.log(count); // Current count",
		"\t\t}, 5000);",
		"\t}, [count]);",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-component-364ble"
/>

### Unnecessary Re-runs

Too many dependencies cause performance issues:

<Code
	code={[
		"function Component({ data }) {",
		"\tconst [filtered, setFiltered] = useState([]);",
		"",
		"\tuseEffect(() => {",
		"\t\tsetFiltered(data.filter((item) => item.active));",
		"\t}, [data, filtered]); // filtered is unnecessary!",
		"\t// This creates an infinite loop",
		"}",
	].join("\n")}
	lang="typescript"
	key="function-component-d-3msiln"
/>

## React Compiler

Note: The React Compiler (when available) will automatically handle many dependency issues, but this rule still helps catch problems during development.

## When Not To Use It

If you're using the React Compiler in production or prefer manual dependency management, you may disable this rule. However, it's strongly recommended for catching common React bugs.

## Related Rules

- [use-hook-at-top-level](/rules/use-hook-at-top-level/) - Enforces hook placement
- [require-named-effect-functions](/rules/require-named-effect-functions/) - Enforces named effect callbacks

## Further Reading

- [React useEffect Dependencies](https://react.dev/reference/react/useEffect#specifying-reactive-dependencies)
- [Biome's Documentation](https://biomejs.dev/linter/rules/use-exhaustive-dependencies/)
- [A Complete Guide to useEffect](https://overreacted.io/a-complete-guide-to-useeffect/)
